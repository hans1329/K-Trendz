@tailwind base;
@tailwind components;
@tailwind utilities;

/* 스크롤 오버슈트 시 빨간색 glow 효과 제거 */
html, body {
  overscroll-behavior: none;
}

/* Definition of the design system. All colors, gradients, fonts, etc should be defined here. 
All colors MUST be HSL.
*/

@layer base {
  :root {
    --background: 210 20% 98%;
    --foreground: 222 47% 11%;

    --card: 0 0% 100%;
    --card-foreground: 222 47% 11%;

    --popover: 0 0% 100%;
    --popover-foreground: 222 47% 11%;

    --primary: 11 100% 46%;
    --primary-foreground: 0 0% 100%;

    --secondary: 210 40% 96%;
    --secondary-foreground: 222 47% 11%;

    --muted: 210 40% 96%;
    --muted-foreground: 215 16% 47%;

    --accent: 11 100% 46%;
    --accent-foreground: 0 0% 100%;

    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;

    --border: 214 32% 91%;
    --input: 214 32% 91%;
    --ring: 11 100% 46%;

    --radius: 0.75rem;

    --upvote: 11 100% 46%;
    --downvote: 221 83% 53%;
    
    --shadow-card: 0 1px 3px 0 hsl(0 0% 0% / 0.1);
    --shadow-card-hover: 0 4px 12px 0 hsl(0 0% 0% / 0.15);
  }

  .dark {
    --background: 222 47% 11%;
    --foreground: 210 40% 98%;

    --card: 217 33% 17%;
    --card-foreground: 210 40% 98%;

    --popover: 217 33% 17%;
    --popover-foreground: 210 40% 98%;

    --primary: 11 100% 46%;
    --primary-foreground: 0 0% 100%;

    --secondary: 217 33% 22%;
    --secondary-foreground: 210 40% 98%;

    --muted: 217 33% 22%;
    --muted-foreground: 215 20% 65%;

    --accent: 11 100% 46%;
    --accent-foreground: 0 0% 100%;

    --destructive: 0 63% 31%;
    --destructive-foreground: 210 40% 98%;

    --border: 217 33% 22%;
    --input: 217 33% 22%;
    --ring: 11 100% 46%;

    --upvote: 11 100% 46%;
    --downvote: 221 83% 53%;
    
    --shadow-card: 0 1px 3px 0 hsl(0 0% 0% / 0.3);
    --shadow-card-hover: 0 4px 12px 0 hsl(0 0% 0% / 0.4);
  }
}

@layer base {
  * {
    @apply border-border;
  }

  html {
    /* html에는 overflow 설정 금지 – 모바일에서 세로 스크롤을 차단할 수 있음 */
    max-width: 100vw;
  }

  body {
    overflow-x: hidden;
    max-width: 100vw;
  }

  body {
    @apply bg-background text-foreground;
    padding-top: 2.5rem; /* 헤더 높이만큼 body에 padding 추가 (모바일: 40px = 2.5rem) */
  }

  /* Navbar가 없는 페이지에서 상단 여백 제거 */
  body.no-top-padding {
    padding-top: 0 !important;
  }

  /* /v2: fixed AppHeader 사용 시, 본문이 헤더에 가리지 않도록 body padding-top을 헤더 높이로 보정 */
  body.v2-fixed-header {
    padding-top: calc(3.5rem + env(safe-area-inset-top, 0px)) !important;
  }

  /* /v2도 앱형 레이아웃이라 #root 기본 패딩/센터링을 제거 */
  body.v2-fixed-header #root {
    padding: 0 !important;
    max-width: 100% !important;
    margin: 0 !important;
    text-align: initial !important;
  }

  /* App.css의 #root 기본 레이아웃(패딩/센터링)도 함께 제거 */
  body.no-top-padding #root {
    padding: 0 !important;
    max-width: 100% !important;
    margin: 0 !important;
    text-align: initial !important;
  }

  /* iOS Safari safe-area-inset-top로 인한 내부 상단 패딩 제거 */
  body.no-top-padding .min-h-screen {
    padding-top: 0 !important;
  }
  
  @media (min-width: 768px) {
    body {
      padding-top: 3rem; /* 데스크톱 헤더 높이 (48px = 3rem) */
    }

    body.no-top-padding {
      padding-top: 0 !important;
    }

    body.v2-fixed-header {
      padding-top: calc(3.5rem + env(safe-area-inset-top, 0px)) !important;
    }
  }

  /* iOS/Android safe area 지원 */
  .safe-area-top {
    padding-top: env(safe-area-inset-top, 0px);
  }

  .safe-area-bottom {
    padding-bottom: env(safe-area-inset-bottom, 0px);
  }
}

@layer utilities {
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  @keyframes gradient-flow {
    0% { background-position: 200% 50%; }
    100% { background-position: 0% 50%; }
  }

  .animate-gradient-flow {
    background-size: 200% 100%;
    animation: gradient-flow 3s linear infinite;
  }

  @keyframes rainbow-flow {
    0% { background-position: 200% 50%; }
    100% { background-position: 0% 50%; }
  }

  .animate-rainbow-flow {
    background-size: 200% 100%;
    animation: rainbow-flow 8s linear infinite;
  }

  @keyframes marquee {
    0% { transform: translateX(100%); }
    100% { transform: translateX(-100%); }
  }

  .animate-marquee {
    display: inline-block;
    animation: marquee 20s linear infinite;
  }

  /* 끊김 없는 무한 루프 마퀴 애니메이션 */
  @keyframes marquee-seamless {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
  }

  .animate-marquee-seamless {
    display: inline-flex;
    animation: marquee-seamless 30s linear infinite;
  }

  .animate-marquee-fast {
    display: inline-block;
    animation: marquee 16s linear infinite;
  }

  @keyframes blink-fade {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
  }

  .animate-blink-fade {
    animation: blink-fade 2s ease-in-out infinite;
  }

  /* 모퉁이 반짝이 애니메이션 - 완전히 사라졌다 나타남 */
  @keyframes sparkle-corner {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0; transform: scale(0.5); }
  }

  .animate-sparkle-1 {
    animation: sparkle-corner 1.5s ease-in-out infinite;
  }

  .animate-sparkle-2 {
    animation: sparkle-corner 1.5s ease-in-out infinite 0.375s;
  }

  .animate-sparkle-3 {
    animation: sparkle-corner 1.5s ease-in-out infinite 0.75s;
  }

  .animate-sparkle-4 {
    animation: sparkle-corner 1.5s ease-in-out infinite 1.125s;
  }

  /* 우주 배경 - 별이 반짝이는 효과 */
  .bg-space {
    background: linear-gradient(to bottom, 
      hsl(240 50% 5%) 0%, 
      hsl(260 60% 8%) 30%, 
      hsl(280 50% 10%) 60%, 
      hsl(260 60% 8%) 80%, 
      hsl(240 50% 5%) 100%
    );
    position: relative;
  }

  .bg-space::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: 
      radial-gradient(2px 2px at 20px 30px, white, transparent),
      radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
      radial-gradient(1px 1px at 90px 40px, white, transparent),
      radial-gradient(2px 2px at 160px 120px, rgba(255,255,255,0.9), transparent),
      radial-gradient(1px 1px at 230px 80px, white, transparent),
      radial-gradient(2px 2px at 300px 180px, rgba(255,255,255,0.7), transparent),
      radial-gradient(1px 1px at 380px 40px, white, transparent),
      radial-gradient(2px 2px at 420px 200px, rgba(255,255,255,0.8), transparent),
      radial-gradient(1px 1px at 520px 90px, white, transparent),
      radial-gradient(2px 2px at 600px 160px, rgba(255,255,255,0.9), transparent),
      radial-gradient(1px 1px at 680px 220px, white, transparent),
      radial-gradient(2px 2px at 750px 50px, rgba(255,255,255,0.7), transparent),
      radial-gradient(1px 1px at 850px 130px, white, transparent),
      radial-gradient(2px 2px at 920px 190px, rgba(255,255,255,0.8), transparent),
      radial-gradient(1px 1px at 100px 250px, white, transparent),
      radial-gradient(2px 2px at 200px 300px, rgba(255,255,255,0.9), transparent),
      radial-gradient(1px 1px at 350px 280px, white, transparent),
      radial-gradient(2px 2px at 500px 320px, rgba(255,255,255,0.7), transparent),
      radial-gradient(1px 1px at 650px 290px, white, transparent),
      radial-gradient(2px 2px at 800px 350px, rgba(255,255,255,0.8), transparent);
    background-repeat: repeat;
    background-size: 1000px 400px;
    pointer-events: none;
    z-index: 0;
    animation: twinkle 4s ease-in-out infinite alternate;
  }

  @keyframes twinkle {
    0% { opacity: 0.6; }
    100% { opacity: 1; }
  }

  .bg-space > * {
    position: relative;
    z-index: 1;
  }

  /* 우주 배경에서 Footer 텍스트 밝게 */
  .bg-space .footer-bottom-text,
  .bg-space .footer-bottom-text span,
  .bg-space .footer-bottom-text p,
  .bg-space .footer-bottom-text a {
    color: hsl(210 40% 80%);
  }
  
  .bg-space .footer-bottom-text a:hover {
    color: hsl(11 100% 60%);
  }

  /* Confetti animation */
  @keyframes confetti-fall {
    0% {
      transform: translateY(0) rotate(0deg);
      opacity: 1;
    }
    100% {
      transform: translateY(100vh) rotate(720deg);
      opacity: 0;
    }
  }

  .animate-confetti {
    animation: confetti-fall linear forwards;
  }

  /* 모바일 스크롤 성능 최적화: blur/backdrop-filter 비용 절감 */
  /* - Tailwind blur/backdrop-blur은 CSS 변수(--tw-*) 기반이라 모바일에서만 강도를 낮춰도 효과가 큼 */
  @media (max-width: 640px) {
    /* backdrop blur 강도 다운 */
    .backdrop-blur-xl { --tw-backdrop-blur: blur(6px); }
    .backdrop-blur-lg { --tw-backdrop-blur: blur(5px); }
    .backdrop-blur-md { --tw-backdrop-blur: blur(4px); }
    .backdrop-blur-sm { --tw-backdrop-blur: blur(3px); }

    /* filter blur 강도 다운 */
    .blur-3xl { --tw-blur: blur(24px); }
    .blur-2xl { --tw-blur: blur(20px); }
    .blur-xl  { --tw-blur: blur(16px); }

    /* 장식 애니메이션은 모바일에서만 비활성화 (스크롤 프레임 안정화) */
    .animate-sparkle-1,
    .animate-sparkle-2,
    .animate-sparkle-3,
    .animate-sparkle-4,
    .animate-pulse {
      animation: none !important;
    }
  }

  /* 긴 리스트/카드 스크롤 최적화 (지원 브라우저에서 오프스크린 렌더 스킵) */
  .content-visibility-auto {
    content-visibility: auto;
    contain-intrinsic-size: 1px 800px;
  }

  /* 작은 카드용 (Rankings Discover 등) */
  .content-visibility-auto-sm {
    content-visibility: auto;
    contain-intrinsic-size: 1px 360px;
  }
}
